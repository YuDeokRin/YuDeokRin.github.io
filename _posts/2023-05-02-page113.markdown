---
# multilingual page pair id, this must pair with translations of this page. (This name must be unique)
# lng_pair: id_autogeneratedsamplecontent_1
title: ì„œë¸”ë¦¿ í•„í„°ë¥¼ ì´ìš©í•´ ë¡œê·¸ ì²˜ë¦¬

# post specific
# if not specified, .name will be used from _data/owner.yml
#author: "Dante"
# multiple category is not supported
category: auto generated
# multiple tag entries are possible
tags: [servlet, filter]
# thumbnail image for post
img: ":servlet.jpg"
# disable comments on this page
comments_disable: true

# publish date
date: 2023-05-02 23:58:00 +0900

# seo
# if not specified, date will be used.
#meta_modify_date: 2023-05-02 23:58:00 +0900
# check the meta_common_description in _data/lang/[language].yml
#meta_description: ""

# optional
# if you enabled image_viewer_posts you don't need to enable this. This is only if image_viewer_posts = false
#image_viewer_on: true
# if you enabled image_lazy_loader_posts you don't need to enable this. This is only if image_lazy_loader_posts = false
#image_lazy_loader_on: true
# exclude from on site search
#on_site_search_exclude: true
# exclude from search engines
#search_engine_exclude: true
# to disable this page, simply set published: false or delete this file
#published: false
---
{%- comment -%} Please delete below and place your page content here {%- endcomment -%}

{%- include util/auto-content-generator.liquid -%}

<!-- outline-start -->

# ì„œë¸”ë¦¿ í•„í„° - ìš”ì²­ ë¡œê·¸

### âš“ï¸ì„œë¸”ë¦¿ í•„í„°ì„ ì´ìš©í•´ ëª¨ë“  ìš”ì²­ì— ë¡œê·¸ë¥¼ ë‚¨ê¸¸ ìˆ˜ ìˆë‹¤. ë§Œë“¤ì–´ë³´ì.

---

## â¡ï¸ì„œë¸”ë¦¿ í•„í„° - ìš”ì²­ ë¡œê·¸

- LogFilter - ë¡œê·¸ í•„í„°

```java
import lombok.extern.slf4j.Slf4j;

import javax.servlet.*;
import javax.servlet.http.HttpServletRequest;
import java.io.IOException;
import java.util.UUID;

@Slf4j
public class LogFilter implements Filter {

    @Override
    public void init(FilterConfig filterConfig) throws ServletException {
        log.info("log filter init");
    }

    @Override
    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {
        HttpServletRequest httpRequest = (HttpServletRequest) request;
        String requestURI = httpRequest.getRequestURI();

        String uuid = UUID.randomUUID().toString();

        try {

        } catch (Exception e){
            throw e;
        } finally{
            log.info("RESPONSE [{}] [{}]", uuid, requestURI);
        }
    }

    @Override
    public void destroy() {
        Filter.super.destroy();
    }
}
```

1. í•„í„°ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ ì¸í„°í˜ì´ìŠ¤ Filterë¥¼ êµ¬í˜„í•œë‹¤.
2. êµ¬í˜„í•´ì•¼í•˜ëŠ” ê²ƒì€ `init()`, `doFilter()`, `destory()` ì„¸ ê°€ì§€ ì´ë‹¤.
3. ê°ì ì œëŒ€ë¡œ ë™ì‘í•˜ëŠ”ì§€ logë¥¼ ë„£ì–´ë³´ì.
  1. `doFilter`ëŠ”  HTTP ìš”ì²­ì´ ì˜¤ë©´ doFilterê°€ í˜¸ì¶œëœë‹¤.
  2. `HttpServletRequest httpRequest`ëŠ” HTTP ìš”ì²­ì´ ì•„ë‹Œ ê²½ìš°ê¹Œì§€ ê³ ë ¤í•´ì„œ ë§Œë“  ì¸í„°í˜ì´ìŠ¤ë‹¤. HTTPë¥¼ ì‚¬ìš©í•˜ë©´ ë‹¤ìš´ ìºìŠ¤íŒ…ì„ í†µí•´ì„œ ì‚¬ìš© í•˜ë©´ëœë‹¤. â†’  `(HttpServletRequest) request;`
4. `uuid` ëŠ” HTTP ìš”ì²­ì„ êµ¬ë³„í•˜ê¸° ìœ„í•´ì„œ ìš”ì²­ë‹¹ ì„ì˜ì˜ UUIDë¥¼ ìƒì„±í•œë‹¤.
5. `log.info(â€REQUEST [{ }] [{ }]â€, uuid, requestURI);` â†’ UUIDì™€ reqeustURIë¥¼ ì¶œë ¥

### ğŸš¨ì¤‘ìš”ğŸš¨Â - `chain.doFilter(requst, response);`

- ë‹¤ìŒ í•„í„°ê°€ ìˆìœ¼ë©´ ë‹¤ìŒ í•„í„°ë¥¼ í˜¸ì¶œí•˜ê³ , í•„í„°ê°€ ì—†ì„ ê²½ìš°  ì„œë¸”ë¦¿ì„ í˜¸ì¶œí•œë‹¤. ì´ ë¡œì§ì„ í˜¸ì¶œí•˜ì§€ ì•ŠëŠ”ë‹¤ë©´ ë‹¤ìŒ ë‹¨ê³„ë¡œ ì§„í–‰ë˜ì§€ ì•ŠëŠ”ë‹¤.

---

## â¡ï¸WebConfig

-

```java
import hello.login.web.filter.LogFilter;
import org.springframework.boot.web.servlet.FilterRegistrationBean;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

import javax.servlet.Filter;

@Configuration
public class WebConfig {

    @Bean
    public FilterRegistrationBean logFilter(){
        FilterRegistrationBean<Filter> filterRegistrationBean = new FilterRegistrationBean<>();
        filterRegistrationBean.setFilter(new LogFilter());
        filterRegistrationBean.setOrder(1);
        filterRegistrationBean.addUrlPatterns("/*");

        return filterRegistrationBean;
    }
}
```

## âœ…ì„œë¸”ë¦¿ í•„í„°

### â¡ï¸í•„í„° íë¦„

```
HTTP ìš”ì²­ â†’ WAS(Tomcat) â†’ filter â†’ Servlet â†’ Controller
```

í•„í„°ë¥¼ ì ìš©í•˜ë©´ í•„í„°ê°€ í˜¸ì¶œ ëœ ë‹¤ìŒì— ì„œë¸”ë¦¿ì´ í˜¸ì¶œëœë‹¤.

- ìŠ¤í”„ë§ì˜ ê²½ìš° : Servlet â†’ DispatcherServlet

```
HTTP ìš”ì²­ â†’ WAS(Tomcat) â†’ filter â†’ DispatcherServlet â†’ Controller
```

### â¡ï¸í•„í„°ì˜ í™œìš©

- ìš”ì²­ ë¡œê·¸ ê¸°ë¡ ë‚¨ê¸°ê¸°
- ë¡œê·¸ì¸ ì—¬ë¶€ ì²´í¬

### â¡ï¸í•„í„° ì²´ì¸

```
HTTP ìš”ì²­ -> WAS(Tomcat) -> í•„í„°1 -> í•„í„°2 -> í•„í„°3 -> ì„œë¸”ë¦¿ -> ì»¨íŠ¸ë¡¤ëŸ¬
```

í•„í„°ëŠ” ì²´ì¸ìœ¼ë¡œ êµ¬ì„±ë˜ëŠ”ë°, ì¤‘ê°„ì— í•„í„°ë¥¼ ììœ ë¡­ê²Œ ì¶”ê°€ í•  ìˆ˜ ìˆë‹¤.

### â¡ï¸í•„í„°ì˜ ìƒëª…ì£¼ê¸°

- `init()` : í•„í„° ì´ˆê¸°í™” ë©”ì„œë“œ, ì„œë¸”ë¦¿ ì»¨í…Œì´ë„ˆê°€ ìƒì„±ë  ë•Œ í˜¸ì¶œëœë‹¤.
- `doFilter()` : ê³ ê°ì˜ ìš”ì²­ì´ ì˜¬ ë•Œ ë§ˆë‹¤ í•´ë‹¹ ë©”ì„œë“œê°€ í˜¸ì¶œëœë‹¤. í•„í„°ì˜ ë¡œì§ì„ êµ¬í˜„í•˜ë©´ ëœë‹¤.
- `destroy()` : í•„í„° ì¢…ë£Œ ë©”ì„œë“œ, ì„œë¸”ë¦¿ ì»¨í…Œì´ë„ˆê°€ ì¢…ë£Œë  ë•Œ í˜¸ì¶œëœë‹¤.

---

### ğŸ“ì¶œì²˜

- [ê¹€ì˜í•œMVC2](https://www.inflearn.com/course/ìŠ¤í”„ë§-mvc-2/dashboard)

---

í•„í„°ë¥¼ ë“±ë¡í•˜ëŠ” ë°©ë²•ì€ ë§ì§€ë§Œ, ìŠ¤í”„ë§ ë¶€íŠ¸ë¥¼ ì‚¬ìš©í•œë‹¤ë©´ `FilterRegistrationBean` ì„ ì‚¬ìš©í•´ì„œ ë“±ë¡í•˜ë©´ ë¨.

- `filterRegistrationBean.setFilter()` : ë“±ë¡í•  í•„í„°ë¥¼ ì§€ì •
- `filterRegistrationBean.setOrder(1)` : í•„í„°ëŠ” ì²´ì¸ìœ¼ë¡œ ë™ì‘í•œë‹¤. ë”°ë¼ì„œ ìˆœì„œê°€ í•„ìš”í•˜ë‹¤. ë‚®ì„ ìˆ˜ë¡ ë¨¼ì € ë™ì‘.
  - `@ServletComponentScan` , `@WebFilter(filterName = â€œlogFilterâ€, urlPatterns = â€œ/*â€`  ë¡œ í•„í„° ë“±ë¡ì´ ê°€ëŠ¥í•œë‹¤, í•˜ì§€ë§Œ í•„í„° ìˆœì„œ ì¡°ì ˆì´ ê¸°ëŠ¥ì´ ì—†ë‹¤.
- `filterRegistrationBean.addUrlPatterns("/*")` : í•„í„°ë¥¼ ì ìš©í•  URL íŒ¨í„´ì„ ì§€ì •í•œë‹¤. í•œë²ˆì— ì—¬ëŸ¬ íŒ¨í„´ì„ ì§€ì •í•  ìˆ˜ ìˆìŒ.

---

## ğŸ“ì°¸ê³ 

- [ê¹€ì˜í•œ MVC 2 í¸ - ë¡œê·¸ì¸ ì²˜ë¦¬ 2 (í•„í„°, ì¸í„°ì…‰í„°)](https://www.inflearn.com/course/ìŠ¤í”„ë§-mvc-2/dashboard)

<!-- outline-end -->

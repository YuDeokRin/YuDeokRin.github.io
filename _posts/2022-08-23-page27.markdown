---
# multilingual page pair id, this must pair with translations of this page. (This name must be unique)
# lng_pair: id_autogeneratedsamplecontent_1
title:Spring Security(CSRF-Synchronizer Token Pattern)

# post specific
# if not specified, .name will be used from _data/owner.yml
#author: "Dante"
# multiple category is not supported
category: auto generated
# multiple tag entries are possible`
tags: [Security, Network, Web]
# thumbnail image for post
img: ":CSRFToken.jpg"
# disable comments on this page
comments_disable: true

# publish date
date: 2022-08-23 23:55:00 +0900

# seo
# if not specified, date will be used.
#meta_modify_date: 2022-08-23 23:55:00 +0900
# check the meta_common_description in _data/lang/[language].yml
#meta_description: ""

# optional
# if you enabled image_viewer_posts you don't need to enable this. This is only if image_viewer_posts = false
#image_viewer_on: true
# if you enabled image_lazy_loader_posts you don't need to enable this. This is only if image_lazy_loader_posts = false
#image_lazy_loader_on: true
# exclude from on site search
#on_site_search_exclude: true
# exclude from search engines
#search_engine_exclude: true
# to disable this page, simply set published: false or delete this file
#published: false
---
{%- comment -%} Please delete below and place your page content here {%- endcomment -%}

{%- include util/auto-content-generator.liquid -%}

<!-- outline-start -->
# CSRF í† í°

CSRF**(Cross-site request forgery)**

ê¸€ì“´ì´ëŠ” CSRFë¥¼ spring securityë¥¼ ì‚¬ìš©í•˜ë©´ì„œ  ì•Œê²Œë˜ì—ˆê¸° ë•Œë¬¸ì—  spring í™˜ê²½ í† ëŒ€ë¡œ ì„¤ëª…ë“œë¦¬ê² ìŠµë‹ˆë‹¤.

# CSRF ê³µê²©ì´ë€?

CSRFì˜ ê³µê²© ìƒí™©ì„ ì˜ˆì‹œë¡œ í™•ì¸í•´ë³´ì.

### ìƒí™© 1

- ì€í–‰ ì›¹ì‚¬ì´íŠ¸ì—ì„œ í˜„ì¬ ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì˜ ëˆì„ ë‹¤ë¥¸ ì€í–‰ ê³„ì¢Œë¡œ ì´ì²´í•  ìˆ˜ ìˆëŠ” ì–‘ì‹ì„ ì œê³µí•œë‹¤ê³  ê°€ì •í•´ë³´ì. ì•„ë˜ì˜ ì½”ë“œëŠ” ì€í–‰ ì›¹ì‚¬ì´íŠ¸  ì „ì†¡ ì–‘ì‹

```html
<form method="post"
	action="/transfer">
<input type="text"
	name="amount"/>
<input type="text"
	name="routingNumber"/>
<input type="text"
	name="account"/>
<input type="submit"
	value="Transfer"/>
</form>
```

- HTTP ìš”ì²­

```html
POST /transfer HTTP/1.1
Host: bank.example.com
Cookie: JSESSIONID=randomid
Content-Type: application/x-www-form-urlencoded

amount=100.00&routingNumber=1234&account=9876
```

### ìƒí™© 2

ì€í–‰ ì›¹ì‚¬ì´íŠ¸ì— ì¸ì¦í•œ ë‹¤ìŒ ë¡œê·¸ì•„ì›ƒì„ í•˜ì§€ì•Šê³  ì•…ì˜ì ì¸ ì›¹ì‚¬ì´íŠ¸ë¥¼ ë°©ë¬¸í•œë‹¤ê³  ê°€ì •í•˜ì.

ì•„ë˜ì˜ ì½”ë“œëŠ” ì•…ì˜ì ì¸ ì›¹ì‚¬ì´íŠ¸ì˜ ì „ì†¡ ë°©ì‹ì˜ ì–‘ì‹

```html
<form method="post"
	action="https://bank.example.com/transfer">
<input type="hidden"
	name="amount"
	value="100.00"/>
<input type="hidden"
	name="routingNumber"
	value="evilsRoutingNumber"/>
<input type="hidden"
	name="account"
	value="evilsAccountNumber"/>
<input type="submit"
	value="Win Money!"/>
</form>
```

ë„ë°• ì‚¬ì´íŠ¸ì—ì„œ ëˆì„ ë”°ê¸° ìœ„í•´ì„œ submit ë²„íŠ¼ì„ ëˆŒë €ë‹¤.  ê·¸ ê³¼ì •ì—ì„œ ì˜ë„ì¹˜ ì•Šê²Œ 100ë‹¬ëŸ¬ë¥¼ ë„ë°• ì‚¬ì´íŠ¸ ì‚¬ìš©ìì—ê²Œ ì „ì†¡í–ˆìŠµë‹ˆë‹¤.

ì´ ìƒí™©ì—ì„œëŠ” ì•…ì˜ì ì¸ ì›¹ì‚¬ì´íŠ¸ê°€ ë‚˜ì˜ ì¿ í‚¤ë¥¼  ë³¼ ìˆ˜ ì—†ì§€ë§Œ ë‚˜ì˜ ì€í–‰ê³¼ ê´€ë ¨ëœ ì¿ í‚¤ê°€ ìš”ì²­ê³¼ í•¨ê»˜ ê³„ì† ì „ì†¡ë˜ê¸° ë•Œë¬¸ì— ë¬¸ì œê°€ ë°œìƒí•œë‹¤.

ê·¸ë ‡ë‹¤ë©´ ì´ ê³µê²©ìœ¼ë¡œë¶€í„° ì•ˆì „í•˜ë ¤ë©´ ì–´ë–»ê²Œí•´ì•¼ë ê¹Œ ?

<aside>
ğŸ’¡ í•´ê²°ì±…

</aside>

CSRF ê³µê²©ì´ ê°€ëŠ¥í•˜ê²Œ ëœ ì´ìœ ëŠ” í”¼í•´ì ì›¹ì‚¬ì´íŠ¸ì˜ HTTP ìš”ì²­ê³¼ ê³µê²©ì ì›¹ì‚¬ì´íŠ¸ì˜ ìš”ì²­ì´ ì •í™•íˆ ë™ì¼í•˜ê¸° ë•Œë¬¸ì´ë‹¤.

CSRFê³µê²©ìœ¼ë¡œë¶€í„° ë³´í˜¸í•˜ë ¤ë©´ ë‘ ìš”ì²­ì„ êµ¬ë³„í•  ìˆ˜ ìˆë„ë¡ ì•…ì˜ì ì¸ ì‚¬ì´íŠ¸ì—ì„œ ì œê³µí•  ìˆ˜ ì—†ëŠ” ìš”ì²­ì´ ìˆëŠ”ì§€ í™•ì¸í•´ì•¼í•œë‹¤.

Springì€ CSRF ê³µê²©ìœ¼ë¡œë¶€í„° ë³´í˜¸í•˜ëŠ” ë‘ ê°€ì§€ ë©”ì»¤ë‹ˆì¦˜ì„ ì œê³µí•œë‹¤.

### 1. ë™ê¸°í™” ì¥ì¹˜ í† í° íŒ¨í„´(**Synchronizer Token Pattern)**

### 2. ì„¸ì…˜ ì¿ í‚¤ì— SameSite ì†ì„± ì§€ì •

ê¸€ì“´ì´ëŠ” í† í° íŒ¨í„´ì´ spring securityì—ì„œ ì‚¬ìš©ë˜ëŠ” ê²ƒì„ ì•Œê²Œë˜ì–´ì„œ ê´€ì‹¬ì´ ë”ìš± ê°”ë‹¤.

íšŒì›ê°€ì… formì—ì„œ ìš”ì²­ì„ ë³´ë‚´ë©´ Securityê°€ CSRFí† í°ì„ ë¶™ì—¬ì„œ ì‘ë‹µì„ í•´ì¤€ë‹¤.

![Untitled](https://user-images.githubusercontent.com/56623911/186190634-9ba79d9f-5d96-47af-96ef-e9ad30f3a71f.png)


`Synchronizer Token Patten`ì€ CSRF ê³µê²©ìœ¼ë¡œë¶€í„° ë³´í˜¸ë¥¼ ê°€ì¥ ë§ì´ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì´ë‹¤. ì´ ë°©ë²•ì€
<!-- outline-end -->

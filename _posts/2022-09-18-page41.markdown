---
# multilingual page pair id, this must pair with translations of this page. (This name must be unique)
# lng_pair: id_autogeneratedsamplecontent_1
title: UserModel ë§Œë“¤ê¸°

# post specific
# if not specified, .name will be used from _data/owner.yml
#author: "Dante"
# multiple category is not supported
category: auto generated
# multiple tag entries are possible`
tags: [Java, Algorithm]
# thumbnail image for post
img: ":UserModel.jpg"
# disable comments on this page
comments_disable: true

# publish date
date: 2022-09-18 22:55:00 +0900

# seo
# if not specified, date will be used.
#meta_modify_date: 2022-09-18 22:55:00 +0900
# check the meta_common_description in _data/lang/[language].yml
#meta_description: ""

# optional
# if you enabled image_viewer_posts you don't need to enable this. This is only if image_viewer_posts = false
#image_viewer_on: true
# if you enabled image_lazy_loader_posts you don't need to enable this. This is only if image_lazy_loader_posts = false
#image_lazy_loader_on: true
# exclude from on site search
#on_site_search_exclude: true
# exclude from search engines
#search_engine_exclude: true
# to disable this page, simply set published: false or delete this file
#published: false
---
{%- comment -%} Please delete below and place your page content here {%- endcomment -%}

{%- include util/auto-content-generator.liquid -%}

<!-- outline-start -->
# User ëª¨ë¸ ë§Œë“¤ê¸°

username, password, email, nameì˜ ë°ì´í„°ë¥¼ ë°›ì„ ìˆ˜ ìˆëŠ” DTO(Data Transfer Object)ë¥¼ ë§Œë“¤ì–´ë³´ì.

```java
â””â”€ğŸ“COME.COS.photogram
   â”‚
   â””â”€ğŸ“web
       â”‚
       â””â”€ ğŸ“dto
            â”‚
            â””â”€ğŸ“auth
            â”‚
            â””â”€ ğŸ“¦Â SignupDto.java
```

### ìƒì„±

package : dto, auth

class : SignupDto.java(Requset DTO)

dto ìš”ì²­, ì‘ë‹µì´ ìˆë‹¤.

- ìš”ì²­ (ë°ì´í„°ë² ì´ìŠ¤ì—ê²Œ)
- ì‘ë‹µ

```java
@Date
public class SignupDto{
	private String username;
	private String password;
	private String email;
	private String name;
}
```

**@Data :  Getterì™€ Setterë¥¼ ë§Œë“¤ì–´ì£¼ëŠ” ì• ë„ˆí…Œì´ì…˜ (Lombokì— ìˆëŠ” ì• ë„ˆí…Œì´ì…˜)**

- **AuthControllerì— signup(SignupDto signupDto)ì— ì¶”ê°€**

**`SignupDto signupDto`** ëŠ” formíƒœê·¸ì—ì„œ ì…ë ¥ëœ ê°’ì´ ë°›ì•„ì˜¨ë‹¤.

```java
@Controller
public class AuthController {

		@PostMapping("/auth/signup")
		public String signup(SignupDto signupDto){
		return "auth/signup";
		}
}
```

form(íƒœê·¸)ìœ¼ë¡œ ë°ì´í„°ê°€ ì˜¤ë©´ ë°ì´í„° í˜•ì‹(Key = value (x-www-form-urlencoded) )

Springì€ ê¸°ë³¸ì ìœ¼ë¡œ `x-www-form-urlencoded` ë°©ì‹ìœ¼ë¡œ ë°ì´í„°ë¥¼ ë°›ì•„ì¤€ë‹¤.

- **ë¡œê·¸ë¥¼ ì°ì–´ì„œ ë°ì´í„°ë¥¼ ì˜ ë°›ì•˜ëŠ”ì§€ í™•ì¸í•´ë³´ì !**

```java
@Controller
public class AuthController {
		private static final logger log = LoggerFactory.getLogger(AuthController.class);

		@PostMapping("/auth/signup")
		public String signup(SignupDto signupDto){
			log.info(signupDto.toString());
			return "auth/signup";
		}
}
```

- ë¡œê·¸ë¥¼ ì°ì–´ë‚¸ ê²°ê³¼ ë°ì´í„°ë¥¼ ì˜ ë°›ì•„ì˜¨ë‹¤.

![Untitled](https://user-images.githubusercontent.com/56623911/190906324-015f9511-0a5e-4efd-99b0-8cacdf98baac.png)

ì ! ë‹¤ìŒ step ë°›ì€ ë°ì´í„°ë“¤ì„ ë°ì´í„°ë² ì´ìŠ¤ì— insert í•´ì¤€ë‹¤.

How ?

ìš°ì„  ëª¨ë¸ì´ í•„ìš” â†’ User ëª¨ë¸

```java
â””â”€ğŸ“COME.COS.photogram
   â”‚
   â””â”€ğŸ“domain
       â”‚
       â””â”€ğŸ“user
			   â”‚
			   â””â”€ğŸ“¦ User.java
```

- ìƒì„±

package : domain, user

class : User.java

```java
//JPA : Java Persistence API(ìë°”ë¡œ ë°ì´í„°ë¥¼ ì˜êµ¬ì ìœ¼ë¡œ ì €ì¥(DBì—)í•  ìˆ˜ ìˆëŠ” APIë¥¼ ì œê³µ)
@AllArgsConstructor // ì „ì²´ ìƒì„±ì
@NoargsConstructor //ë¹ˆ ìƒì„±ì
@Data // Getter/Setter
@Entity //DBì— í…Œì´ë¸”ì„ ìƒì„±í•´ì¤€ë‹¤.
public class User{
		private int id;   // Long id

		private String username;
		private String password;

		private String name; // ì´ë¦„
		private String website;  // ì›¹ì‚¬ì´íŠ¸
		private String bio; // ìê¸° ì†Œê°œ
		private String email;
		private String phone;
		private String gender;

		private String profileimageUrl; // í›—ë‚  ì‘ì„±ìì˜ ì‚¬ì§„ì´ë  ë³€ìˆ˜
		private String role; //ê¶Œí•œ

		//ë°ì´í„°ë² ì´ìŠ¤ì—ê²Œ ë°ì´í„°ê°€ ì–¸ì œ ë“¤ì–´ ì™”ëŠ”ì§€ í•­ìƒ í•„ìš”í•˜ë‹¤.
		private LocalDateTime createDate; // ë°ì´í„°ê°€ ì–¸ì œ ë“¤ì–´ì™”ëŠ”ì§€ ë°ì´í„°ë² ì´ìŠ¤ëŠ” í•„ìš”í•˜ë‹¤ !

		@PrePersist // createDate()ê°€ ë°ì´í„°ë² ì´ìŠ¤ì— insertë˜ê¸° ì§ì „ì— PrePersistê°€ ì‹¤í–‰
		public void createDate(){
			this.createDate = LocalDateTime.now();
		}
}
```

ì‹¤ì œ ì„œë¹„ìŠ¤ë¥¼ í•œë‹¤ë©´ `Long`ìœ¼ë¡œ í•˜ëŠ”ê²Œ ì¢‹ê¸´í•˜ë‹¤. í•˜ì§€ë§Œ ì—¬ê¸°ì„  ë¯¸ë‹ˆí”„ë¡œì íŠ¸ì´ë‹ˆ `int`ë¡œ í•˜ê² ë‹¤.

| ì •ìˆ˜í˜• íƒ€ì… | í• ë‹¹ë˜ëŠ” ë©”ëª¨ë¦¬ì˜ í¬ê¸° | ë°ì´í„°ì˜ í‘œí˜„ ë²”ìœ„ |
| --- | --- | --- |
| byte | 1ë°”ì´íŠ¸ | -128 ~ 127 |
| short | 2ë°”ì´íŠ¸ | -215Â ~ (215Â - 1) |
|  |  | -32,768 ~ 32,767 |
| int | 4ë°”ì´íŠ¸ | -231Â ~ (231Â - 1) |
|  |  | -2,147,483,648 ~ 2,147,483,647 |
| long | 8ë°”ì´íŠ¸ | -263Â ~ (263Â - 1) |
|  |  | -9,223,372,036,854,775,808 ~Â 9,223,372,036,854,775,807 |

- ë°ì´í„°ë² ì´ìŠ¤ì— ê°’ì„ ë„£ì–´ì¤„ ë•Œ, ìœ„ì— ë°ì´í„°(username, password, name, website, bio, email, phone, gender)ë¥¼ ë„£ì–´ì£¼ë©´ createDate()ëŠ” ìë™ìœ¼ë¡œ ë“¤ì–´ê°„ë‹¤.

createDate()ëŠ” ë°ì´í„°ë¥¼ ë„£ì€ ì‹œê°„ì„ ë‚˜íƒ€ë‚¸ë‹¤.

```java
		@PrePersist // createDate()ê°€ ë°ì´í„°ë² ì´ìŠ¤ì— insertë˜ê¸° ì§ì „ì— PrePersistê°€ ì‹¤í–‰
		public void createDate(){
			this.createDate = LocalDateTime.now();
		}
```

- @Entity : DBì— í…Œì´ë¸”ì„ ìƒì„±í•´ì¤€ë‹¤.
- @Data : Getter/Setter ìƒì„±
- @NoargsConstructor :ë¹ˆ ìƒì„±ì
- @AllArgsConstructor :ì „ì²´ ìƒì„±ì

```java
@AllArgsConstructor // ì „ì²´ ìƒì„±ì
@NoargsConstructor //ë¹ˆ ìƒì„±ì
@Data // Getter/Setter ìƒì„±
@Entity //ë””ë¹„ì— í…Œì´ë¸”ì„ ìƒì„±í•´ì¤€ë‹¤.
public class User{
}
```

ì–´í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰ ! í•˜ì§€ë§Œ ì‹¤íŒ¨ â€¦

**why? Error Primary keyê°€ ì—†ì–´ì„œ ì˜¤ë¥˜ë‚˜ëŠ” ê²ƒì´ë‹¤. â†’** `Entityì— ëŒ€í•œ ì‹ë³„(identifier)ì´ ì—†ë‹¤.`

> ì˜¤ë¥˜ ë©”ì‹œì§€ - No identifier specified for entity : com.cos.photogram.domain.user.User
>

```java
@NoargsConstructor //ë¹ˆ ìƒì„±ì
@Data // Getter/Setter
@Entity //ë””ë¹„ì— í…Œì´ë¸”ì„ ìƒì„±í•´ì¤€ë‹¤.
public class User{

		@Id
		@GeneratedValue(strategy = GenerationType.IDENTITY) // ë²ˆí˜¸ ì¦ê°€ ì „ëµì´ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ë”°ë¼ê°„ë‹¤.
		private int id;   // primary key

		private String username;
		private String password;

		private String name; // ì´ë¦„
		private String website;  // ì›¹ì‚¬ì´íŠ¸
		private String bio; // ìê¸° ì†Œê°œ
		private String email;
		private String phone;
		private String gender;

		private String profileimageUrl; // í›—ë‚  ì‘ì„±ìì˜ ì‚¬ì§„ì´ë  ë³€ìˆ˜
		private String role; //ê¶Œí•œ

		//ë°ì´í„°ë² ì´ìŠ¤ì—ê²Œ ë°ì´í„°ê°€ ì–¸ì œ ë“¤ì–´ ì™”ëŠ”ì§€ í•­ìƒ í•„ìš”í•˜ë‹¤.
		private LocalDateTime createDate; // ë°ì´í„°ê°€ ì–¸ì œ ë“¤ì–´ì™”ëŠ”ì§€ ë°ì´í„°ë² ì´ìŠ¤ëŠ” í•„ìš”í•˜ë‹¤ !

		@PrePersist // createDate()ê°€ ë°ì´í„°ë² ì´ìŠ¤ì— insertë˜ê¸° ì§ì „ì— PrePersistê°€ ì‹¤í–‰
		public void createDate(){
			this.createDate = LocalDateTime.now();
		}
}
```

ì¶”ê°€

> @GeneratedValue(strategy = GenerationType.IDENTITY)
>

- ë²ˆí˜¸ ì¦ê°€ ì „ëµ(`strategy = GenerationType.IDENTITY`)ì´ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ë”°ë¼ê°„ë‹¤.
  - mysql, mariadb- **`Auto Increment`ì„ ì“´ë‹¤.**
  - Oracle - **`SequenceGenerator`ì„ ì“´ë‹¤.**

### ë°ì´í„°ë² ì´ìŠ¤ì—  ì ‘ì†í•œë‹¤.

![Untitled 1](https://user-images.githubusercontent.com/56623911/190906312-7f8c6490-8e14-4b80-b92b-ce4128b6344c.png)

![Untitled 2](https://user-images.githubusercontent.com/56623911/190906317-6d3a0849-e376-4e99-ba6c-b55a8de4db45.png)

ì´ëŸ° ì‹ìœ¼ë¡œ í…Œì´ë¸”ì´ ë§Œë“¤ì–´ì§„ë‹¤.   ê°ì²´ë¥¼ í…Œì´ë¸”ë¡œ ë§Œë“¤ì–´ ?!!!  ì´ê²Œ ORMì˜ ì„¸ê³„ ?!!!

ëŒ€ë°•..

![tumblr_mijuioESRS1qg6rkio1_500](https://user-images.githubusercontent.com/56623911/190906281-dfb03bd2-cd40-40ee-8f68-42cd5e9ca5f5.gif)

### **application.yml  ì•ˆì— JPA â†’ ddl-autoì˜ ì—­í• ì€?**

ddl-auto

- update : ë°ì´í„°ë¥¼ insertí•˜ê³  ë‚˜ì„œ ì„œë²„ë¥¼ ë‹¤ì‹œ ì‹¤í–‰í•´ë„ ìœ ì§€ë˜ì–´ ë‚¨ì•„ìˆê²Œ í•´ì¤€ë‹¤.
- create : ë°ì´í„°ë¥¼ insertí•˜ê³  ë‚˜ì„œ ì„œë²„ë¥¼ ì¬ì‹¤í–‰í•˜ë©´ insertí–ˆë˜ ë°ì´í„°ê°€ ë‹¤ ì‚¬ë¼ì§„ë‹¤.

```yaml
jpa:
open-in-view:true
  hibernate:
ddl-auto: create
naming:
physical-strategy: org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl
show-sql:true

```

## UserModel ê¸€ì„ ì“´ íšŒê³ 
UserModelì„ ì§ì ‘ ë§Œë“¤ê³  JPAë¥¼ ì“°ë‹ˆê¹.. ì™€ ì •ë§ í¸í•˜ë‹¤. ì ì  íˆ´ì´ ê·¹ì ì¸ ê¸°ëŠ¥ì„ ê°–ê³  ë‚˜íƒ€ë‚  ê²ƒê°™ë‹¤. ì´ë¯¸ ë‚˜ì˜¨ ê²ƒë§Œ ë´ë„.. ì…ì´ ë‹¤ë¬¼ì–´ì§€ì§€ ì•ŠëŠ”ë‹¤.
ëŒ€ë°•ì´ë‹¤..


<!-- outline-end -->

---
# multilingual page pair id, this must pair with translations of this page. (This name must be unique)
# lng_pair: id_autogeneratedsamplecontent_1
title: MyBatisì˜ '${}'ì™€ '#{}'

# post specific
# if not specified, .name will be used from _data/owner.yml
#author: "Dante"
# multiple category is not supported
category: auto generated
# multiple tag entries are possible
tags: [Mybatis, SQLMapper]
# thumbnail image for post
img: ":mybatis.jpg"
# disable comments on this page
comments_disable: true

# publish date
date: 2023-04-19 23:32:00 +0900

# seo
# if not specified, date will be used.
#meta_modify_date: 2023-04-19 23:32:00 +0900
# check the meta_common_description in _data/lang/[language].yml
#meta_description: ""

# optional
# if you enabled image_viewer_posts you don't need to enable this. This is only if image_viewer_posts = false
#image_viewer_on: true
# if you enabled image_lazy_loader_posts you don't need to enable this. This is only if image_lazy_loader_posts = false
#image_lazy_loader_on: true
# exclude from on site search
#on_site_search_exclude: true
# exclude from search engines
#search_engine_exclude: true
# to disable this page, simply set published: false or delete this file
#published: false
---
{%- comment -%} Please delete below and place your page content here {%- endcomment -%}

{%- include util/auto-content-generator.liquid -%}

<!-- outline-start -->

# #{} vs ${}

## âš“ï¸ì„œë¡ 

mybatisì—ì„œ ì¤‘ìš”í•œ ë¬¸ë²•ì´ë‹¤. ë©´ì ‘ì—ì„œë„ ë§ì´ ë‚˜ì˜¤ëŠ” ì§ˆë¬¸ ì¤‘ í•˜ë‚˜ì¸ ê²ƒ ê°™ë‹¤.

í•„ì ì—­ì‹œë„ ì§ˆë¬¸ì„ ë°›ì•˜ë‹¤.

ì´ë²ˆ ê¸°íšŒì— í•œë²ˆ ì •ë¦¬í•˜ê³  ë„˜ì–´ê°€ì•¼ê² ë‹¤.

---

## â¡ï¸Statement ì™€ PreparedStatement

ë³¸ë¡ ì— ë“¤ì–´ê°€ê¸° ì•ì„œ ê°„ë‹¨íˆ Statement ì™€ PreparedStatementì˜ ì°¨ì´ë¥¼ ê°„ë‹¨íˆ ì•Œê³  ë„˜ì–´ê°€ì.

ë‘ ê°œì˜ ê°€ì¥ í° ì°¨ì´ì ì€ ìºì‹œë¥¼ ì‚¬ìš©í•˜ëŠ”ì§€ ì•ˆí•˜ëŠ”ì§€ê°€ í° ì°¨ì´ë¥¼ ê°€ë¥¸ë‹¤.

### âœ… Statementë¥¼ ì‚¬ìš©í•˜ë©´

- ë§¤ë²ˆ ì¿¼ë¦¬ë¥¼ ìˆ˜í–‰í•  ë•Œ 3ë‹¨ê³„ë¥¼ ê±°ì¹œë‹¤.
1. ì¿¼ë¦¬ ë¬¸ì¥ ë¶„ì„
2. ì»´íŒŒì¼
3. ì‹¤í–‰

ë°˜ë©´ì—â€¦

### âœ…PreparedStatementë¥¼ ì‚¬ìš©í•˜ë©´

- ì²˜ìŒì—ë§Œ 3ë‹¨ê³„ë¥¼ ê±°ì¹˜ê³  cacheë¥¼ ì‚¬ìš©í•˜ì—¬ ë‹´ì•„ì„œ ì¬ì‚¬ìš©í•œë‹¤.

ë”°ë¼ì„œ ë°˜ë³µì ìœ¼ë¡œ ì¿¼ë¦¬ê°€ ìˆ˜í–‰ëœë‹¤ë©´ PreparedStatementë¥¼ ì‚¬ìš©í•˜ëŠ”ê²ƒ ì¢‹ê³  DBì—ë„ ë¶€ë‹´ì„ ëœ ì¤€ë‹¤.

---

## â¡ï¸XMLì—ì„œ ${  }ë¥¼ ì‚¬ìš©í•˜ë©´

### 1ï¸âƒ£ê°’ì´ ë„£ì–´ì§„ ì±„ë¡œ ì¿¼ë¦¬ë¬¸ì„ ìˆ˜í–‰í•œë‹¤.

- ë”°ë¼ì„œ íŒŒë¼ë¯¸í„°ì˜ ê°’ì´ ë°”ë€Œë‹¤ë©´, ì¿¼ë¦¬ë¬¸ íŒŒì‹±ì„ ë§¤ë²ˆ ì§„í–‰í•œë‹¤.  â†’ ì„±ëŠ¥ì´ ëŠë¦¼



### 2ï¸âƒ£ì¿¼ë¦¬ë¬¸ì— ì‘ì€ ë”°ì˜´í‘œ(â€™)ê°€ ë¶™ì§€ ì•ŠëŠ”ë‹¤.

- ë”°ë¼ì„œ  í…Œì´ë¸” ì´ë¦„ì´ë‚˜ ì»¬ëŸ¼ ì´ë¦„ì„ ë™ì ìœ¼ë¡œ ê²°ì •í•  ë•Œ ì‚¬ìš© ê°€ëŠ¥í•˜ë‹¤ â†’
- cf. `#{ }`ëŠ”  ì‘ì€ ë”°ì˜´í‘œ(â€™)ê°€ ë¶™ìŒ

```xml
<select id="select" resultType="String" parameterType="Map">
    SELECT
        name AS ì´ë¦„
    FROM
        user_${id}
    WHERE
        id = #{id}
</select>
```

---

## â¡ï¸XMLì—ì„œ #{  }ë¥¼ ì‚¬ìš©í•˜ë©´

- `#{ }` ì˜ˆì œ -  ì¿¼ë¦¬ë¬¸

```xml
<select id="select" resultType="String" parameterType="Map">
    SELECT
        name AS ì´ë¦„
    FROM
        user
    WHERE
        id = #{id}
</select>
```

- MyBatisì—ì„œëŠ” `#{ }` ì´ ì‚¬ìš©ëœ í€´ë¦¬ê°€ ì‹¤í–‰ë˜ë©´ íŒŒì‹±ë˜ë©´ì„œ `#{ }` â†’ `?` ìœ¼ë¡œ ëœë‹¤.

```xml
SELECT
    name AS ì´ë¦„, email AS ì´ë©”ì¼
FROM
    user
WHERE
    id = ?
```

ì—¬ê¸°ì„œ ìœ„ì—ì„œ ê°„ë‹¨íˆ ì•Œì•„ë´¤ë˜ `PreparedStatement` ê°œë…ì´ ë“¤ì–´ê°„ë‹¤.

`#{ }` ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš° `PreparedStatement` ë¥¼ ìƒì„±í•˜ê²Œ ë˜ëŠ”ë° ìœ„ì˜ `?` ì— íŒŒë¼ë¯¸í„°ê°€ ë°”ì¸ë”©ë˜ì–´ ìˆ˜í–‰ëœë‹¤.

ë”°ë¼ì„œ íŒŒì‹±ëœ ì¿¼ë¦¬ë¬¸ì€ ìºì‹±ë˜ì–´ì„œ ì¬í™œìš©ìœ¼ë¡œ ì“°ì´ê¸° ë•Œë¬¸ì— íš¨ìœ¨ì ìœ¼ë¡œ ì“¸ ìˆ˜ ìˆë‹¤.

### âœ…ì‘ì€ ë”°ì˜´í‘œ(â€™)ëŠ” ìë™ìœ¼ë¡œ ë¶™ì—¬ì„œ ìˆ˜í–‰ëœë‹¤.

- `#{id}`  â†’  `'#{id}'` ìœ¼ë¡œ ìë™ìœ¼ë¡œ ì²˜ë¦¬í•´ì¤€ë‹¤.

- í…Œì´ë¸” ì„¤ê³„ê°€ `user_a`, `user_b`  ê°ê° êµ¬ì„±ë˜ì–´ìˆì„ ë•Œ , ì•„ë˜ì™€ ê°™ì€ ë°©ë²•ìœ¼ë¡œëŠ” ì‘ì„±ì´ ë¶ˆê°€í•˜ë‹¤. ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•˜ë©´ `tableId`  ì‘ì€ ë”°ì˜´í‘œê°€ ë¶™ê¸° ë•Œë¬¸ì— `SQLSyntaxErrorException` ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤.

```xml

<select id="select" resultType="String" parameterType="Map">>
    SELECT
        name AS ì´ë¦„
    FROM
        user_#{tableId}
    WHERE
        id = #{id}
</select>
```

---

## â¡ï¸SQL Inject

- ë³´ì•ˆ ê´€ë ¨ ì´ìŠˆ

```xml
<select id="selectUserFromTable" parameterType="Map" resultType="...">
    SELECT
        *
    FROM
        user
    WHERE
        id = '${id}' AND password = '${password}'
</select>
```

- ë§Œì¼ id íŒŒë¼ë¯¸í„°ì˜ ê°’ìœ¼ë¡œ `â€˜adminâ€™`  `â€”`ì´ ì…ë ¥ë˜ëŠ” ê²½ìš° â†’ WHERE ì ˆì—ì„œ ë¹„ë°€ë²ˆí˜¸ì— ì¡°ê±´ì´ ì‚¬ë¼ì§€ê²Œ ë˜ì–´ idë§Œ ì…ë ¥í•´ë„ ê´€ë¦¬ì ê³„ì • ì •ë³´ë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆê²Œ ëœë‹¤.
- ê²°ë¡  : `${}` ì‚¬ìš©í•˜ëŠ” ê²½ìš° SQL Injectionì— ì·¨ì•½í•˜ë‹¤.

```xml
SELECT
    *
FROM
    user
WHERE
    id = 'admin' -- 'AND password = ''
```

---

## ğŸ“ì°¸ê³ 

- Statement ì™€ PreparedStatement

[https://devbox.tistory.com/entry/Comporison](https://devbox.tistory.com/entry/Comporison)

- ****MyBatisì—ì„œ ìƒ¾(#{})ê³¼ ë‹¬ëŸ¬(${})ì˜ ì°¨ì´ëŠ” ë¬´ì—‡ì¼ê¹Œ?****

[https://madplay.github.io/post/difference-between-dollar-sign-and-sharp-sign-in-mybatis](https://madplay.github.io/post/difference-between-dollar-sign-and-sharp-sign-in-mybatis)

<!-- outline-end -->
